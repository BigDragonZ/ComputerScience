# 介绍

C语言是20世纪70年代初期在贝尔实验室开发出来的编程语言，语言本身的特点：

* 强类型语言
* 编译型语言

## 历史背景

**诞生历史**

C语言其实是Unix操作系统的副产品。

* 1969年 Ken Thompson使用汇编语言编写出Unix操作系统的最初版本
* 1970年为了解决汇编程序难以调试和改进的问题， Ken Thompson基于BCPL语言设计了B语言，并使用B语言重写了部分unix代码，但是B语言在数据类型支持方面不够完善
* 1972-1973年期间， Dennis Ritchie着手开发B语言的升级版，期初成为New B语言，后来由于与B语言的差异越来越大，于是改名为C语言
* 1973使用C语言重新编写Unix操作系统

在当时来说C语言相对其他语言的优势：

1、可移植性，只需要编写对应计算机的C语言编译器即可

2、在操作系统等底层开发方便，功能和灵活性表现更好

**标准化**

* 1978年Ken Thompson和Dennis Ritchie合作编写的<<C语言设计语言>>成为了事实上的标准，称为KR或白皮书
* 80年代，C语言迅速普及，由于白皮书对一些语言 特性的表述比较模糊，导致在不同平台、不同开发者之间无法实现通用性
* 1983年，ANSI开始指定C语言标准，88年完成，89年正式发布，成为C89或C90标准
* 1995年,C语言又发生了一些变动，99年发布新标准C99
* 2011年发布C11
* 2018年发布C18

## 优缺点

讨论优缺点之前，首先要理解C语言的基础理论体系。

* 底层语言：为了适应系统编程的需要，C语言提供了对机器级概念(比如字节和地址)的访问，除此之外，还提供了与计算机内置指令紧密协调的操作，使得程序可以快速执行

* 小型语言：与其他语言相比，C语言提供了一套更优先的特性集合，为了保持较少量的特性，C语言很大程序上依赖标准函数库

* 包容性语言：C语言对用户的要求更高些，提供了比其他许多语言更多的自由度，此外，C语言没有强制进行详细的错误检查

与当前的很多编程语言来说，C语言的优缺点都很明显：

优点

* 高效：早期计算机配置不高，而且C语言设计之初是为了替代汇编语言的，所以对性能的要求就比较高，能在有限的内存空间内快速运行
* 功能：unix系统都是由C语言写的
* 与unix集成比较容易，这一点毋庸置疑

缺点

* 灵活的另一个含义就是容易出错，难以理解
* 很多错误都需要在运行时才能检测出来

# 基本概念

一个简单的C程序

```c
#include <stdio.h>

int main(void) {
    printf("Hello World\n");
    return 0;
}
```

## 执行流程

编译阶段

* 预处理：
  * 编译器首先会调用预处理器对源文件进行预处理操作。在此过程中，会处理以 “#” 开头的预处理指令，比如 “#include” 指令会将指定的头文件内容包含到当前源文件中，像 “#include <stdio.h>” 会把标准输入输出头文件的相关声明添加进来，为后续代码中使用输入输出函数等做好准备；“#define” 指令会进行宏定义替换，将程序中定义的宏标识符替换成对应的内容等。
  * 经过预处理后，源文件内容得到扩充和初步整理，生成一个中间文件，不过这个文件通常是临时的，不会直接展现给程序员。
* 编译：
  * 接着，编译器会对预处理后的文件进行正式的编译操作，将 C 语言的源程序代码转换为目标机器对应的汇编语言代码。编译器会依据 C 语言的语法、语义规则，对源文件中的语句进行分析，比如判断变量声明是否合法、表达式计算是否正确、函数调用是否符合规范等，对于不符合规则的代码会报错提示程序员修改。
  * 这个阶段结束后，会生成以 “.obj”（在 Windows 系统下）或 “.o”（在 Unix、Linux 等系统下）为后缀的目标文件，它是汇编语言代码形式的文件，距离机器可执行代码更近了一步。

链接阶段

* 目标文件整合
  * 当一个 C 程序由多个源文件（比如多个 “.c” 文件）或者使用了外部库（像标准 C 库中的函数等）时，链接器就开始发挥作用了。它会把各个编译生成的目标文件以及相关的库文件进行整合，解决不同文件之间的符号引用关系，比如某个源文件中调用了另一个源文件里定义的函数，链接器就要确保函数的正确调用和地址关联。
  * 链接器会查找相应的库文件（.lib 文件在 Windows 系统下，.a 或.so 文件在 Unix、Linux 等系统下），将程序中用到的库函数的代码链接到最终的可执行文件中，确保程序能完整地执行相应的功能。
* 生成可执行文件
  * 经过链接操作后，最终会生成一个可执行文件，在 Windows 系统下其后缀通常为 “.exe”，在 Unix、Linux 等系统下一般没有特定后缀（可以通过赋予执行权限来运行）。这个可执行文件就是最终可以在相应操作系统上运行的程序版本了。

运行阶段

* 加载执行
  - 当用户在操作系统中双击可执行文件（在 Windows 系统下常见操作）或者在命令行输入相应的执行命令（在 Unix、Linux 等系统下常用操作）后，操作系统会将可执行文件加载到内存中，然后按照程序中设定的逻辑开始执行。
  - 程序会从入口函数（通常是 “main” 函数）开始，依次执行函数内的语句，包括变量初始化、根据控制语句进行条件判断、循环操作等，按照代码编写的顺序和逻辑逐步推进程序的运行，直到遇到程序结束的条件（比如 “main” 函数执行完毕等）。
* 结果输出与终止
  - 在运行过程中，如果程序中有输出语句（比如使用 “printf” 函数输出信息），相应的内容会显示在控制台或者其他指定的输出设备上。
  - 当程序执行完所有语句或者遇到终止程序的特定情况（如异常错误等）后，程序就会结束运行，释放占用的内存等资源，完成整个 C 程序的一次执行过程。

## 程序的组成

```C
#include <stdio.h> 

int main(void) {
    // 输出
    printf("Hello World\n");
    return 0;
}
```

### 指令

预处理指令是以 “#” 开头的命令，它并非 C 语言本身的语句，而是在编译之前由预处理器进行处理的内容，常见的有以下几种类型：

1. **文件包含指令**：例如 “#include <stdio.h>” 或 “#include "myheader.h"”。“#include <stdio.h>” 用于将标准输入输出头文件的内容引入到当前源文件中，使得程序可以使用诸如 “printf”“scanf” 等标准输入输出函数；而 “#include "myheader.h"” 则是把用户自定义的头文件（通常包含一些函数声明、宏定义等内容）包含进来，方便代码的组织和复用。
2. **宏定义指令**：像 “#define PI 3.1415926”，通过这样的指令可以定义宏，将程序中出现的 “PI” 标识符统一替换为 “3.1415926” 这个数值，常用来定义一些常量或者简单的代码片段替换，有助于提高代码的可读性和可维护性，同时也能在一定程度上方便代码的修改（只需修改宏定义处的值即可影响所有使用该宏的地方）。
3. **条件编译指令**：比如 “#ifdef DEBUG”“#endif”，可以根据是否定义了某个标识符（如这里的 “DEBUG”）来决定是否编译某段代码。在调试程序时，定义 “DEBUG” 标识符，就可以让一些调试相关的代码（如输出调试信息的语句）参与编译；而在正式发布程序时，不定义 “DEBUG”，这些调试代码就不会被编译进去，有助于控制程序的最终生成代码量以及避免不必要的信息输出等。

### 函数

函数是 C 程序的基本构建块，主要分为：

* **主函数 “main”**：它是 C 程序的入口点，程序运行时会首先从 “main” 函数开始执行
* 自定义函数：除了 “main” 函数外，程序员可以根据程序的功能需求定义各种各样的函数来实现特定的任务

### 语句

语句是程序运行时执行的命令。

1. **表达式语句**：例如 “a = 5;”，它是由一个赋值表达式加上一个分号构成的语句，完成将数值 5 赋给变量 “a” 的操作；再比如 “b++;” 也是表达式语句，实现对变量 “b” 进行自增 1 的操作。
2. **控制语句**：包括条件判断语句（如 “if” 语句：“if (a > 10) { printf ("a 大于 10\n"); }”，根据条件 “a > 10” 的真假来决定是否执行花括号内的语句块；“switch” 语句可以根据一个表达式的值在多个分支中选择执行相应的语句）、循环语句（“while” 循环：“while (i < 10) { i++; }”，只要条件 “i < 10” 成立就会不断执行循环体内的语句；“for” 循环：“for (int i = 0; i < 10; i++) { }” 常用于已知循环次数的情况，能更方便地控制循环的初始值、终止条件和步长；“do - while” 循环与 “while” 循环类似，但它是先执行一次循环体，再判断循环条件是否成立）等，这些控制语句可以控制程序的执行流程，使程序按照预期的逻辑运行。
3. **函数调用语句**：例如 “printf ("Hello\n");” 就是调用了 “printf” 函数来输出 “Hello” 这个字符串，通过函数调用语句可以利用已有的函数实现各种功能，像输入输出操作、数学运算等。

### 注释

负责对程序进行解释说明。

```c
// 单行注释 双斜杠
/*
多行注释
*/
```

### 变量

变量用于存储数据，在 C 语言中有不同的数据类型对应不同的变量，常见的数据类型包括：

1. **基本数据类型**：如整型（“int”），可以用来存储整数，例如 “int age = 20;” 就定义了一个名为 “age” 的整型变量并赋值为 20；浮点型（“float”“double”），用于存储带有小数部分的数据，像 “float score = 98.5;”；字符型（“char”），用于存储单个字符，比如 “char grade = 'A';”。
2. **构造数据类型**：例如数组（“int arr [5];” 定义了一个能存储 5 个整数的整型数组）、结构体（可以将不同类型的数据组合在一起，如定义一个表示学生信息的结构体：

### 运算符

* 算数运算符 `+ - * / % ` 
* 关系运算符 ` > < >= <= == != `
* 逻辑运算符`&& || !`
* 复合运算符`++ -- += -= *= /=`

### 语句

选择语句

循环语句

跳转语句

```c
// 注意 C99之前int i 要在for语句之前声明
for (int i = 1; i <= 10; i++) {
}
```





